@use '../../../core/ui/themes/default/theme' as *;
@use '../../../core/ui/utilities/utility-layout' as *;
@use '../../../core/ui/utilities/utility-text' as *;

$shading-animation-delay: .5s;
$shading-animation-time: 1.5s;

$content-animation-delay: $shading-animation-time + $shading-animation-delay - 1.25s;
$content-animation-time: 2.5s;
$content-ease: cubic-bezier(0, 1, .25, 1);

$shadow-animation-delay: $shading-animation-time + $shading-animation-delay - 1s;
$shadow-animation-time: 2.5s;

$banner-animation-delay: $content-animation-time + $content-animation-delay - .75s;
$banner-opacity-time: 1s;
$banner-animation-time: 1.85s;
$banner-ease: cubic-bezier(0.33, 1, 0.68, 1);

$slow-zoom-delay: $content-animation-delay + $content-animation-time + 3s;
$slow-zoom-time: 10s;

.age-ending__small-text {
	line-height: pixels(36);
	letter-spacing: pixels(8);
	margin-right: pixels(-8);
}

.age-ending__main-text {
	line-height: normal;
	font-size: calc(4rem);
	letter-spacing: 1rem;
	font-weight: 400;
}

.age-ending__panel-text-ornament {
	width: 33%;
	height: 12%;
	background-image: url("fs://game/age-banner_ornament.png");
	background-size: contain;
	background-repeat: no-repeat;
	background-position: center;
	align-self: center;
	transform: translate(-60%, 0);
	opacity: 0.2;
	margin-left: 39.5%;
	filter: fxs-color-mask(color(secondary));
}

.age-ending__panel-text-ornament-bottom {
	transform: translate(-60%, 0) scale3d(1, -1, 0);
}

.age-ending__big-filligree-hslot {
	width: 99%;
}

.age-ending-filligree-top {
	top: pixels(-9);
}

.age-ending-filligree-bottom {
	top: pixels(5);
}

.age-ending__panel-big-ornament {
	border-image-source: url('fs://game/age-banner_filligree.png');
	border-image-slice: 60 256 2 48 fill;
	border-image-width: pixels(64) pixels(256) pixels(8) pixels(48);
}

.age-ending__banner-text {
	animation-name: banner-fade-in, banner-move-down, age-ending-end-part-1;
	animation-delay: 2.5s;
	animation-duration: 1s, 1.85s, 2.85s;
	animation-timing-function: linear, cubic-bezier(0.33, 1, 0.68, 1), linear;
	animation-fill-mode: both;
}

@keyframes center-bar-slide-out {
	100% {
		transform: scale(.825);
	}
}

@keyframes center-bar-fade-out {
	100% {
		opacity: 0;
	}
}

@keyframes fade-in-and-zoom-center-bar {
	0% {
		opacity: 0;
		transform: translateY(pixels(-960)) scale(6);
	}

	25% {
		opacity: 1;
	}

	100% {
		transform: translateY(pixels(0)) scale(1);
	}
}

.age-ending__panel {
	height: pixels(300);
	transform-origin: 50% 50%;
	animation-name: fade-in-and-zoom-center-bar;
	animation-delay: $content-animation-delay;
	animation-duration: $content-animation-time;
	animation-timing-function: $content-ease;
	animation-fill-mode: both;

	&.age-ending__panel--fade-out {
		animation-name: center-bar-slide-out, center-bar-fade-out;
		animation-delay: 2.625s, 2.375s;
		animation-duration: 2.75s, 3s;
		animation-timing-function: cubic-bezier(.25, 0, 1, .85), cubic-bezier(0, .15, .75, 1);
		animation-fill-mode: both;

		.age-ending__panel-darkening {
			animation-name: darkening-fade-in;
			animation-delay: 2.375s;
			animation-duration: 3s;
			animation-timing-function: cubic-bezier(0, .15, .75, 1);
			animation-fill-mode: forwards;
			animation-direction: normal;
			opacity: 0;
		}
	}

	&.age-ending__panel--fade-out-banner {
		.age-ending__small-banner {
			animation-name: banner-fade-in;
			animation-delay: 1.25s;
			animation-duration: .75s;
			animation-timing-function: linear;
			animation-fill-mode: forwards;
			animation-direction: reverse;
			opacity: 1;
		}
	}

	&.age-ending__panel--pause-animations {
		animation-play-state: paused;

		div {
			animation-play-state: paused;
		}
	}
}

.age-ending__panel-main {
	display: flex;
	flex-direction: column;
	justify-content: center;
	align-items: center;
	animation-name: panel-slow-zoom;
	animation-delay: $slow-zoom-delay;
	animation-duration: $slow-zoom-time;
	animation-timing-function: linear;
	animation-fill-mode: both;
}

.age-ending__panel-shadow {
	position: absolute;
	top: pixels(-6);
	left: 0;
	right: 0;
	bottom: pixels(-24);
	opacity: 0;
	background-image: linear-gradient(to top, rgba(var(--clr-panel__overlay-dark), .0) pixels(0), rgba(var(--clr-panel__overlay-dark), 1) pixels(24), rgba(var(--clr-panel__overlay-dark), 1) 95%, rgba(var(--clr-panel__overlay-dark), 0) 100%);
	animation-name: fade-in-bar-drop-shadow;
	animation-delay: $shadow-animation-delay;
	animation-duration: $shadow-animation-time;
	animation-timing-function: $content-ease;
	animation-fill-mode: both;
}

@keyframes fade-in-bar-drop-shadow {
	0% {
		opacity: 0;
		transform: translateX(pixels(-192)) translateY(pixels(768));
	}

	100% {
		opacity: 1;
		transform: translateX(pixels(0)) translateY(pixels(0));
	}
}

.age-ending__panel-bg {
	border-image-source: url('fs://game/base_tooltip-bg.png');
	border-image-slice: 18 24 36 18 fill;
	border-image-outset: pixels(6) pixels(16) pixels(24) pixels(16);
	border-image-width: pixels(16) pixels(24) pixels(36) pixels(24);
	display: flex;
	background-image: linear-gradient(to bottom, color('primary-4', .95) 0%, color('primary-5', .95) 100%);
}

.age-summary__container {
	opacity: 0;
	animation-delay: 0s;
	animation-duration: .75s;
	animation-timing-function: linear;
	animation-fill-mode: both;
	flex-direction: column;
	justify-content: flex-start;

	&.age-summary_container--active {
		animation-name: banner-fade-in;
	}
}

@keyframes banner-fade-in {
	0% {
		opacity: 0;
	}

	100% {
		opacity: 1;
	}
}

@keyframes banner-move-down {
	0% {
		transform: translateY(-100%);
	}

	100% {
		transform: translateY(0%);
	}
}

@keyframes banner-line-stretch {
	0% {
		transform: scaleX(0);
	}

	100% {
		transform: scaleX(1);
	}
}

@keyframes age-ending-end-part-1 {
	0% {
		border-width: 0;
	}

	100% {
		border-width: 0;
	}
}

@keyframes age-ending-end-part-2 {
	0% {
		border-width: 0;
	}

	100% {
		border-width: 0;
	}
}

@keyframes age-ending-end-part-3 {
	0% {
		border-width: 0;
	}

	100% {
		border-width: 0;
	}
}